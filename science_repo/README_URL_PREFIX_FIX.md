# URL Prefix Duplication Fix

## Issue Description

Tests were failing with 404 errors because URLs had the path prefix `/srahmel/living-science-documents` duplicated, resulting in URLs like:

```
/srahmel/living-science-documents/srahmel/living-science-documents/api/ai/ai-comment-suggestions/1/approve/
```

instead of the correct path:

```
/srahmel/living-science-documents/api/ai/ai-comment-suggestions/1/approve/
```

## Root Cause

The issue was caused by the `FORCE_SCRIPT_NAME` setting in Django, which was set to `/srahmel/living-science-documents` in the `.env` file. This setting causes Django to add this prefix to all URLs generated by the `reverse()` function.

In the test environment, when tests constructed URLs using `reverse()`, they were already getting the prefix `/srahmel/living-science-documents` added. But then when the tests made requests to these URLs, they were adding the same prefix again, resulting in duplicated paths.

## Solution

The solution was to modify `settings.py` to set `FORCE_SCRIPT_NAME` to `None` when running tests, regardless of what's in the `.env` file. This prevents the URL duplication issue in the test environment.

Changes made:

1. Added import for `sys` at the top of `settings.py`:
   ```python
   import sys
   ```

2. Modified the `FORCE_SCRIPT_NAME` setting to check if running tests:
   ```python
   # Set FORCE_SCRIPT_NAME to None when running tests to prevent URL duplication
   # This fixes the issue where test URLs have /srahmel/living-science-documents twice
   if 'test' in sys.argv:
       FORCE_SCRIPT_NAME = None
   else:
       FORCE_SCRIPT_NAME = config('FORCE_SCRIPT_NAME', default=None)
   ```

This fix ensures that when running tests, Django doesn't add the `/srahmel/living-science-documents` prefix to URLs generated by `reverse()`, which prevents the duplication issue.

## Verification

The fix was implemented based on analysis of the issue and standard Django practices for handling URL prefixes in test environments. When running tests in a normal environment, this fix should resolve the URL duplication issue and allow the tests to pass.